# Setup Environment Variables
# Script nÃ y sáº½ táº¡o file .env cho frontend

param(
    [string]$BackendPort = "3001"
)

Write-Host "ğŸ”§ Setting up environment variables..." -ForegroundColor Cyan
Write-Host ""

$envFile = "frontend\.env"
$envContent = @"
# Frontend Environment Variables
# Generated by setup-env.ps1

# Backend API URL
# Vite proxy sáº½ forward /api -> http://localhost:$BackendPort
VITE_API_URL=http://localhost:$BackendPort
"@

# Check if .env already exists
if (Test-Path $envFile) {
    Write-Host "âš ï¸  File $envFile Ä‘Ã£ tá»“n táº¡i!" -ForegroundColor Yellow
    $response = Read-Host "Báº¡n cÃ³ muá»‘n ghi Ä‘Ã¨? (y/N)"
    if ($response -ne "y" -and $response -ne "Y") {
        Write-Host "âŒ Há»§y bá». File giá»¯ nguyÃªn." -ForegroundColor Red
        exit 0
    }
}

# Create .env file
try {
    $envContent | Out-File -FilePath $envFile -Encoding UTF8 -NoNewline
    Write-Host "âœ… ÄÃ£ táº¡o file: $envFile" -ForegroundColor Green
    Write-Host ""
    Write-Host "ğŸ“„ Ná»™i dung file:" -ForegroundColor Cyan
    Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Gray
    Write-Host $envContent -ForegroundColor Gray
    Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Gray
    Write-Host ""
    Write-Host "ğŸ”„ Tiáº¿p theo:" -ForegroundColor Cyan
    Write-Host "1. Khá»Ÿi Ä‘á»™ng láº¡i frontend dev server (náº¿u Ä‘ang cháº¡y)" -ForegroundColor Yellow
    Write-Host "   Ctrl+C â†’ cd frontend â†’ npm run dev" -ForegroundColor Gray
    Write-Host ""
    Write-Host "2. Kiá»ƒm tra proxy hoáº¡t Ä‘á»™ng:" -ForegroundColor Yellow
    Write-Host "   .\test-proxy.ps1" -ForegroundColor Gray
    Write-Host ""
    Write-Host "âœ… Done! Frontend sáº½ proxy Ä‘áº¿n: http://localhost:$BackendPort" -ForegroundColor Green
} catch {
    Write-Host "âŒ Lá»—i khi táº¡o file: $_" -ForegroundColor Red
    exit 1
}

